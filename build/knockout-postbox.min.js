//knockout-postbox v0.2.1 | (c) 2012 Ryan Niemeyer | http://www.opensource.org/licenses/mit-license
!function(a){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?a(require("knockout")):typeof define=="function"&&define.amd?define(["knockout"],a):a(ko)}(function(a,b){var c,d,e;e=a.postbox=new a.subscribable,e.topicCache={},e.publish=function(b,c){b&&(e.topicCache[b]={value:c,serialized:a.toJSON(c)},e.notifySubscribers(c,b))},d=e.subscribe,e.subscribe=function(a,b,c){if(a)return d.call(e,b,c,a)},e.defaultComparer=function(b,c){return b===c.value&&a.toJSON(b)===c.serialized},a.subscribable.fn.publishOn=function(a,b,d){var f;return a&&(typeof b=="function"?d=b:f=b,d=d||e.defaultComparer,c.call(this,a,"publishOn"),this.postboxSubs[a].publishOn=this.subscribe(function(b){d.call(this,b,e.topicCache[a])||e.publish(a,b)},this),f||e.publish(a,this())),this},c=function(a,b){var c=this.postboxSubs=this.postboxSubs||{};c[a]=c[a]||{},c[a][b]&&c[a][b].dispose()},a.subscribable.fn.stopPublishingOn=function(a){return c.call(this,a,"publishOn"),this},a.subscribable.fn.subscribeTo=function(d,f,g){var h,i,j,k=this;return typeof f=="function"?g=f:h=f,d&&a.isWriteableObservable(this)&&(c.call(this,d,"subscribeTo"),j=function(a){k(g?g.call(k,a):a)},this.postboxSubs[d].subscribeTo=e.subscribe(d,j),h&&(i=e.topicCache[d],i!==b&&j(i.value))),this},a.subscribable.fn.unsubscribeFrom=function(a){return c.call(this,a,"subscribeTo"),this},a.subscribable.fn.syncWith=function(a,b,c,d){return this.subscribeTo(a,b).publishOn(a,c,d),this}})